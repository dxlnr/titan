<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<!-- <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self'; img-src 'self' data:; connect-src http://www.chessdb.cn http://explorer.lichess.ovh"> -->
	<title>Titan Chess Engine</title>
    <link rel="stylesheet" type="text/css" href="static/chessboard.css">

    <script src="static/jquery.min.js"></script>
    <script src="static/chessboard.js"></script>
</head>

<body>
        
    <div id="board" style="width: 600px"></div>
    <button id="startBtn" style="margin: 8px">Reset Position</button>
    <button id="clearBtn" style="margin: 8px">Clear Board</button>

    <!-- <p>Where is the board?</p> -->

    <script type="text/javascript">

        var board = Chessboard('board', {
            position: 'start',
            draggable: true,
            onDrop: onDrop,
        });

        function onDrop (source, target, piece, newPos, oldPos, orientation) {
            if(source == target) return

            var pos = Chessboard.objToFen(newPos);
            $.post('/move', { 'new_pos': pos } );

            $.get('/engine_move', function(r) {
                board.move(r);
            }); 

            console.log('Source: ' + source)
            console.log('Target: ' + target)
            console.log('Piece: ' + piece)
            console.log('New position: ' + Chessboard.objToFen(newPos))
            console.log('Old position: ' + Chessboard.objToFen(oldPos))
        }


        
        $('#startBtn').on('click', board.start)
        $('#clearBtn').on('click', board.clear)
    </script>

</body>
</html>
